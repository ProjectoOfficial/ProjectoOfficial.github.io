<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Projecto</title>
    <link rel="icon" href="media/images/LOGOPNG.png" type="image/x-icon">
    <link rel="shortcut icon" href="media/images/LOGOPNG.png" type="image/x-icon">
    
    <link rel="stylesheet" type="text/css" href="styles/header.css">
    <link rel="stylesheet" type="text/css" href="styles/body.css">
    <link rel="stylesheet" type="text/css" href="styles/code.css">
    <link rel="stylesheet" type="text/css" href="styles/darkmode.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js" defer></script>

</head>
<body>
    <header>
        <a href="index.html"> <img src="media/images/LOGOPNG.png" alt="Il Tuo Logo"> </a>
        <nav>
            <div class="header__container">
                <button class="menu-toggle" id="menuToggle">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </button>
        
                <div class="nav-content">
                    <ul class="nav-links">
                        <li><a href="#Intro" class="nav-link" data-translate="link-intro"></a></li>
                        <li><a href="#lecture0" class="nav-link">0</a></li>
                        <li><a href="#lecture1" class="nav-link">1</a></li>
                        <li><a href="#lecture2" class="nav-link">2</a></li>
                        <li><a href="#lecture3" class="nav-link">3</a></li>
                        <li><a href="#lecture4" class="nav-link">4</a></li>
                        <li><a href="#lecture5" class="nav-link">5</a></li>
                    </ul>
                </div>
        
                <div class="nav-controls">
                    <label class="switch">
                        <input type="checkbox" id="darkModeToggle">
                        <span class="switch__slider">
                            <span class="switch__icon">
                                <i class="fa fa-sun icon-light"></i>
                                <i class="fa fa-moon icon-dark"></i>
                            </span>
                        </span>
                    </label>
                    <select id="languageSelector" class="form-control">
                        <option value="it">ðŸ‡®ðŸ‡¹</option>
                        <option value="en">ðŸ‡¬ðŸ‡§</option>
                    </select>
                </div>
        
                <div class="social-icons">
                    <a href="https://youtube.com/ProjectoOfficial" target="_blank" class="header__icon">
                        <i class="fab fa-youtube"></i>
                    </a>
                    <a href="https://www.tiktok.com/@officialprojecto" target="_blank" class="header__icon">
                        <i class="fab fa-tiktok"></i>
                    </a>
                    <a href="https://www.facebook.com/MiniProjectsOfficial" target="_blank" class="header__icon">
                        <i class="fab fa-facebook"></i>
                    </a>
                    <a href="https://instagram.com/officialprojecto" target="_blank" class="header__icon">
                        <i class="fab fa-instagram"></i>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <body>
        <div id="main_container">
            <section id="Intro" class="section">
                <h2 data-translate="introduction-title"></h2>
                <p data-translate="introduction-text"></p>
            </section>

            <section id="lecture0" class="section">
                <h2 data-translate="lecture-0-title"></h2>
                <p data-translate="lecture-0-text"> </p>
                <div class="code_container">
                    <pre>
                    <code class="language-python">
    import torch

    # Check if CUDA is correctly installed and the GPU is available
    print(f"Is CUDA available? {torch.cuda.is_available()}")
    print(f"How many CUDA devices are available? {torch.cuda.device_count()}")
    print(f"Name of the CUDA device: {torch.cuda.get_device_name(0)}")


    # Select the device to be used for the computation
    device = torch.device('cuda') if torch.cuda.is_available() else torch.device('cpu')

    # Create a tensor and send it to the device:
    # 1. The tensor is directly created on the device (more efficient)
    z = torch.tensor([[1, 2, 3, 4], [4, 5, 6, 8]], dtype=torch.float32, device=device)

    # 2. The tensor is created on the CPU and then moved to the device
    x = torch.tensor([[1, 2, 3, 4], [4, 5, 6, 8]]).to(torch.float32).to(device)

    print(z)
    print(x)

    # With z.shape we can get the shape of the tensor which indicates the number of elements in each dimension
    print(z.shape)

    # With z.size() we can get the total number of elements in the tensor
    print(z.size())

    # With z.numel() we can get the total number of elements in the tensor as well
    print(z.numel())

    # We can also get the data type of the tensor with z.dtype
    print(z.dtype)

    # Since we can also set the tensor's device, we can check the device of the tensor with z.device
    print(z.device)

    # Now, it is possible to create a tensor manually as we've seen before,
    # but PyTorch provides a variety of functions to create tensors with specific properties.
    # For instance, we can create a tensor with all zeros with torch.zeros(shape)
    z = torch.zeros((4, 4), dtype=torch.float32, device=device)
    print(z)

    # Similarly, we can create a tensor with all ones with torch.ones(shape)
    x = torch.ones((4, 4), dtype=torch.float32, device=device)
    print(x)

    # We can also create a tensor with random values with torch.rand(shape)
    y = torch.rand((4, 4), device=device)
    print(y)

    # We can generate a tensor with random values from a normal distribution with torch.randn(shape)
    y = torch.randn((4, 4), device=device)
    print(y)

    # We can also choose one value used to populate a tensor with torch.full(shape, value)
    z = torch.full((4, 4), 42, device=device)
    print(z)

    # There are multiple ways to create tensors with specific properties, my suggestion is to check the documentation
                    </code>
                    <button class="copy-label" id="copyButton" title="Copia codice">
                        <i class="fas fa-copy"></i>
                    </button>
                    <div class="feedback" id="feedback">Copiato!</div>        
                    </pre>


                    <div class="video_container">
                        <iframe src="https://www.youtube.com/embed/vMGmyZAYR24"></iframe>
                    </div>
                </div>
            </section>

            <section id="lecture1" class="section">
                <h2 data-translate="lecture-1-title"></h2>
                <p data-translate="lecture-1-text"> </p>
                <div class="code_container">
                    <pre>
                    <code class="language-python">
    import torch

    device = torch.device('cuda') if torch.cuda.is_available() else torch.device('cpu')
    
    # Stride is a property of the tensor which indicates the number of elements in the memory 
    # between two consecutive elements in the tensor dimension
    z = torch.zeros((2, 2), dtype=torch.float64, device=device)
    print(z.stride())
    
    # pytorch operations allow us to perform element-wise operations on tensors
    # For instance, we can multiply a tensor with a scalar
    z = torch.ones((2, 2), dtype=torch.float64, device=device) * 2
    print(z)
    
    # We can also multiply two tensors element-wise, but they must have the same shape
    y = torch.ones((2, 2), dtype=torch.float64, device=device) * 6
    k = z * y
    print(k)
    
    # We can perform element-wise addition, subtraction, division, and exponentiation as well
    k = z + y
    print(k) # Addition
    
    k = z - y
    print(k) # Subtraction
    
    k = z / y
    print(k) # Division
    
    k = z ** y
    print(k) # Exponentiation
    
    # We can perform these operations in some cases where the tensors have different shapes
    # as long as the shapes are broadcastable
    # The tensor must have the same shape except for the one dimension
    y = torch.ones((1, 2), dtype=torch.float64, device=device) * 6
    k = z - y
    print(k)
    
    # Operations such as sum, mean, max, min, etc. can be performed on tensors
    # These operations can be performed along a specific dimension
    # This dimension will obviously collapse in one resulting element
    # For instance, we can sum all the elements of a tensor
    z = torch.ones((2, 4), dtype=torch.float64, device=device) * 2
    print(z)
    
    k = z.sum(dim=1)
    print(k)
    print(k.shape)
    
    # It is possible to preserve the dimension of the resulting tensor by setting keepdim=True
    k = z.sum(dim=1, keepdim=True)
    print(k)
    print(k.shape)
    
    # To concatenate two tensors along a specific dimension, we can use torch.cat
    # The tensors must have the same shape except for the dimension along which they are concatenated
    z = torch.ones((2, 2), dtype=torch.float64, device=device) * 2
    y = torch.ones((2, 2), dtype=torch.float64, device=device) * 6
    k = torch.cat((z, y), dim=0)
    print(k)
    print(k.shape)
                    </code>
                    <button class="copy-label" id="copyButton" title="Copia codice">
                        <i class="fas fa-copy"></i>
                    </button>
                    <div class="feedback" id="feedback">Copiato!</div>        
                    </pre>


                    <div class="video_container">
                        <iframe src="https://www.youtube.com/embed/Vf2rSP1Ki40"></iframe>
                    </div>
                </div>
            </section>

            <section id="lecture2" class="section">
                <h2 data-translate="lecture-2-title"></h2>
                <p data-translate="lecture-2-text"> </p>
                <div class="code_container">
                    <pre>
                    <code class="language-python">
    import torch

    device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
    
    # since we will use random tensors, it is better to fix the seed
    torch.manual_seed(42)
    
    
    ################### BROADCASTING
    # Here broadcasting is automatically done. What happen under the hood is that the
    # smaller tensor is expanded to match the shape of the larger tensor.
    def broadcasting():
        z = torch.ones([2, 2], dtype=torch.float32, device=device)
        y = torch.rand([2, 1], dtype=torch.float32, device=device)
    
        print(z * 3)
    
        # The previous is equivalent to the following
        print(z * torch.tensor([3, 3], dtype=torch.float32, device=device))
    
        # Broadcast takes place also with tensors of different shapes
        print(z * y)
    
        # The previous is equivalent to the following
        print(z * y.expand(z.shape))
    
        # We can even drop the last dimension of y that it will be still automatically broadcasted
        print(y.squeeze().shape)
        print(z * y.squeeze())
    
        # it works even if z is multi-dimensional, as long as its dimensions are multiples of y's dimensions
        z = torch.ones([2, 2, 4, 2], dtype=torch.float32, device=device)
        y = torch.ones([2], dtype=torch.float32, device=device) * 2
        print(z * y.squeeze())
    
        # it does not work if the dimensions are not multiples
        try:
            z = torch.ones([2, 2, 4, 2], dtype=torch.float32, device=device)
            y = torch.ones([3], dtype=torch.float32, device=device) * 2
            print(z * y.squeeze())
        except RuntimeError as e:
            print(e)
    
    ################### SQUEEZE AND UNSQUEEZE
    # Squeeze removes all the dimensions of size 1
    def squeeze_unsqueeze():
        z = torch.ones([2, 1, 2, 1], dtype=torch.float32, device=device)
        print(z.squeeze().shape)
    
        # squeeze can take a dimension as argument
        print(z.squeeze(1).shape)
    
        # Unsqueeze adds a dimension of size 1
        z = torch.ones([2, 2], dtype=torch.float32, device=device)
        print(z.unsqueeze(0).shape)
    
    ################### INDEXING AND SLICING
    def indexing_slicing():
        # Indexing and slicing works as in numpy
        z = torch.ones([10, 2, 3], dtype=torch.float32, device=device)
    
        # get the first row
        print(z[:, 0])
        # get the first column
        print(z[0, :])
        # get the last dimension
        print(z[..., -1])
    
        # we can also use boolean masks
        z = torch.tensor([-1, 9, 3, -34, 12], dtype=torch.float32, device=device)
        mask = z > 0
        print(z[mask])
    
        # we can also use the where function: where(condition, x, y)
        # torch.where returns x if condition is True, y otherwise
        print(torch.where(mask, z, torch.zeros_like(z)))
    
        # we can also use the gather function
        # gather(input, dim, index)
        # input: tensor from which to gather values
        # dim: the dimension along which to index
        # index: the indices of the values to gather
        z = torch.tensor([[1, 2], [3, 4], [5, 6]], dtype=torch.float32, device=device)
        print(torch.gather(z, 1, torch.tensor([[0], [1], [0]], device=device)))
        
    
    if __name__ == "__main__":
        # broadcasting()
        # squeeze_unsqueeze()
        indexing_slicing()
                    </code>
                    <button class="copy-label" id="copyButton" title="Copia codice">
                        <i class="fas fa-copy"></i>
                    </button>
                    <div class="feedback" id="feedback">Copiato!</div>        
                    </pre>


                    <div class="video_container">
                        <iframe src="https://www.youtube.com/embed/zmT8tg71ak8"></iframe>
                    </div>
                </div>
            </section>

        </div>
        <button id="scrollToTopBtn" data-translate="button_scrollup"></button>
</body>

<footer>
    <p>Manually Translated Website - Last Update: 22/aug/2024</p>
    <p>&copy; 2024 ProjectoOfficial.github.io</p>
</footer>

<script>
    document.getElementById('menuToggle').addEventListener('click', function() {
    document.querySelector('.nav-content').classList.toggle('active');
    });

    // Close menu when a link is clicked
    document.querySelectorAll('.nav-link').forEach(link => {
        link.addEventListener('click', function() {
            document.querySelector('.nav-content').classList.remove('active');
        });
    });

    document.addEventListener('DOMContentLoaded', () => {
            hljs.highlightAll();
        });

    document.getElementById('copyButton').addEventListener('click', () => {
        const codeBlock = document.querySelector('pre code');
        const codeText = codeBlock.textContent;

        navigator.clipboard.writeText(codeText).then(() => {
            const copyIcon = document.querySelector('#copyButton i');
            const feedback = document.getElementById('feedback');

            copyIcon.classList.remove('fa-copy');
            copyIcon.classList.add('fa-check');

            feedback.classList.remove('hide');
            feedback.classList.add('show');

            setTimeout(() => {
                feedback.classList.remove('show');
                feedback.classList.add('hide');
                copyIcon.classList.remove('fa-check');
                copyIcon.classList.add('fa-copy');
            }, 400);
        }).catch(err => {
            console.error('Errore nella copia del codice: ', err);
        });
    });
</script>


<script src="js/script.js" defer></script>
<script src="js/darkmode.js" defer></script>
<script src="js/scrolltotop.js" defer></script>
<script src="js/translate.js" defer></script>

</html>